<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tennis Ball Game</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(to bottom, #2d5016, #4a7c59);
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .game-container {
            text-align: center;
            position: relative;
        }
        
        canvas {
            border: 3px solid #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.3);
            background: linear-gradient(to bottom, #2d5016, #4a7c59);
        }
        
        .controls {
            margin-top: 20px;
            color: #ffffff;
        }
        
        .score {
            font-size: 24px;
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .start-screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(45, 80, 22, 0.95);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.3);
            border: 2px solid #ffffff;
        }
        
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(45, 80, 22, 0.95);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.3);
            border: 2px solid #ffffff;
            display: none;
        }
        
        .countdown {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(45, 80, 22, 0.95);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.3);
            border: 2px solid #ffffff;
            display: none;
            z-index: 1000;
        }
        
        .countdown-number {
            font-size: 72px;
            font-weight: bold;
            color: #ffffff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            margin: 0;
            animation: pulse 0.5s ease-in-out;
        }
        
        .level-up {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(45, 80, 22, 0.95);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.3);
            border: 2px solid #ffffff;
            display: none;
            z-index: 1000;
            animation: levelUpPulse 1s ease-in-out;
        }
        
        @keyframes levelUpPulse {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .start-btn, .restart-btn {
            background: linear-gradient(45deg, #ffffff, #f0f0f0);
            color: #2d5016;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }
        
        .start-btn:hover, .restart-btn:hover {
            background: linear-gradient(45deg, #f0f0f0, #ffffff);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.5);
        }
        
        .game-title {
            font-size: 32px;
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
        }
        
        .instructions {
            color: #e8f5e8;
            margin-bottom: 20px;
            font-size: 16px;
        }
        
        h2 {
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        p {
            color: #e8f5e8;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="score">Score: <span id="score">0</span> | Level: <span id="level">1</span></div>
        <canvas id="gameCanvas" width="400" height="600"></canvas>
        <div class="controls">
            <p>Click or press SPACE to bounce!</p>
        </div>
        
        <div class="start-screen" id="startScreen">
            <div class="game-title">ðŸŽ¾ Tennis Ball</div>
            <div class="instructions">
                <p>Bounce through the tennis nets!</p>
                <p>Click or press SPACE to bounce</p>
            </div>
            <button class="start-btn" onclick="startGame()">Start Match</button>
        </div>
        
        <div class="game-over" id="gameOver">
            <h2>Match Point!</h2>
            <p>Final Score: <span id="finalScore">0</span></p>
            <p id="highScoreMessage" style="color: #e8f5e8; font-size: 18px; margin: 15px 0;"></p>
            <button class="restart-btn" onclick="restartGame()">New Match</button>
        </div>
        
        <div class="countdown" id="countdown">
            <div class="countdown-number" id="countdownNumber">3</div>
        </div>
        
        <div class="level-up" id="levelUp">
            <div style="font-size: 24px; font-weight: bold; color: #ffffff;">ðŸŽ¾ LEVEL UP! ðŸŽ¾</div>
            <div style="font-size: 18px; color: #e8f5e8; margin-top: 10px;">Level <span id="newLevel">2</span></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const gameOverElement = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');
        const startScreenElement = document.getElementById('startScreen');
        const countdownElement = document.getElementById('countdown');
        const countdownNumberElement = document.getElementById('countdownNumber');
        const levelUpElement = document.getElementById('levelUp');
        const newLevelElement = document.getElementById('newLevel');

        // Game variables
        let gameRunning = false;
        let gameStarted = false;
        let countdownActive = false;
        let countdownValue = 3;
        let score = 0;
        let level = 1;
        let baseNetSpeed = 2;
        let baseNetFrequency = 120;
        let nikhilHighScore = 15; // Nikhil's high score
        let gravity = 0.5;
        let velocity = 0;
        let ballY = 300;
        let ballX = 50;
        let ballSize = 20;
        let nets = [];
        let netWidth = 60;
        let netGap = 150;
        let netSpeed = 2;
        let frameCount = 0;
        let courtLines = [];

        // Tennis ball properties
        const ball = {
            x: ballX,
            y: ballY,
            size: ballSize,
            velocity: 0,
            gravity: 0.5,
            bouncePower: -8
        };

        // Tennis player properties
        const player = {
            x: 30,
            y: 500,
            width: 25,
            height: 40,
            speed: 3,
            jumpSpeed: 0,
            jumpPower: -8,
            gravity: 0.4,
            isJumping: false,
            racketX: 0,
            racketY: 0,
            targetX: 30,
            targetY: 500
        };

        // Initialize court lines
        function initCourtLines() {
            courtLines = [];
            // Add horizontal court lines
            for (let i = 0; i < 5; i++) {
                courtLines.push({
                    x: 0,
                    y: 100 + i * 100,
                    width: canvas.width,
                    height: 2
                });
            }
        }

        // Initialize game
        function init() {
            ball.y = 300;
            ball.velocity = 0;
            nets = [];
            score = 0;
            level = 1;
            levelElement.textContent = level;
            frameCount = 0;
            scoreElement.textContent = score;
            gameOverElement.style.display = 'none';
            startScreenElement.style.display = 'block';
            countdownElement.style.display = 'none';
            levelUpElement.style.display = 'none';
            gameRunning = false;
            gameStarted = false;
            countdownActive = false;
            countdownValue = 3;
            initCourtLines();
            // Reset player position and state
            player.x = 30;
            player.y = 500;
            player.jumpSpeed = 0;
            player.isJumping = false;
            player.racketX = player.x + player.width + 5;
            player.racketY = player.y + 15;
        }

        // Start the game
        function startGame() {
            gameStarted = true;
            startScreenElement.style.display = 'none';
            countdownActive = true;
            countdownValue = 3;
            countdownNumberElement.textContent = countdownValue;
            countdownElement.style.display = 'block';
            startCountdown();
        }

        // Countdown function
        function startCountdown() {
            const countdownInterval = setInterval(() => {
                countdownValue--;
                countdownNumberElement.textContent = countdownValue;
                
                if (countdownValue <= 0) {
                    clearInterval(countdownInterval);
                    countdownNumberElement.textContent = 'GO!';
                    
                    setTimeout(() => {
                        countdownElement.style.display = 'none';
                        countdownActive = false;
                        gameRunning = true;
                        gameLoop();
                    }, 500);
                }
            }, 1000);
        }

        // Create new net
        function createNet() {
            const gapY = Math.random() * (canvas.height - netGap - 100) + 50;
            nets.push({
                x: canvas.width,
                gapY: gapY,
                passed: false
            });
        }

        // Update ball physics
        function updateBall() {
            ball.velocity += ball.gravity;
            ball.y += ball.velocity;
        }

        // Update player position to follow ball
        function updatePlayer() {
            // Calculate target position based on ball location
            player.targetX = ball.x - 20;
            player.targetY = ball.y + 50; // Player stays below the ball
            
            // Horizontal movement with acceleration
            const dx = player.targetX - player.x;
            if (Math.abs(dx) > 5) {
                if (dx > 0) {
                    player.x += player.speed;
                } else {
                    player.x -= player.speed;
                }
            }
            
            // Jump when ball is high and player is on ground
            if (ball.y < 200 && !player.isJumping && player.y >= 500) {
                player.jumpSpeed = player.jumpPower;
                player.isJumping = true;
            }
            
            // Apply gravity and vertical movement
            if (player.isJumping) {
                player.jumpSpeed += player.gravity;
                player.y += player.jumpSpeed;
                
                // Land on ground
                if (player.y >= 500) {
                    player.y = 500;
                    player.jumpSpeed = 0;
                    player.isJumping = false;
                }
            }
            
            // Keep player within canvas bounds
            if (player.x < 0) player.x = 0;
            if (player.x > canvas.width - player.width) player.x = canvas.width - player.width;
            
            // Update racket position relative to player
            player.racketX = player.x + player.width + 5;
            player.racketY = player.y + 15;
        }

        // Calculate current net speed based on level
        function getCurrentNetSpeed() {
            return baseNetSpeed + (level - 1) * 0.5;
        }

        // Calculate current net frequency based on level
        function getCurrentNetFrequency() {
            return Math.max(60, baseNetFrequency - (level - 1) * 10);
        }

        // Update level based on score
        function updateLevel() {
            const newLevel = Math.floor(score / 10) + 1;
            if (newLevel > level) {
                level = newLevel;
                levelElement.textContent = level;
                newLevelElement.textContent = level;
                levelUpElement.style.display = 'block';
                setTimeout(() => {
                    levelUpElement.style.display = 'none';
                }, 2000); // Hide after 2 seconds
            }
        }

        // Update nets
        function updateNets() {
            const currentSpeed = getCurrentNetSpeed();
            for (let i = nets.length - 1; i >= 0; i--) {
                nets[i].x -= currentSpeed;
                
                // Remove nets that are off screen
                if (nets[i].x + netWidth < 0) {
                    nets.splice(i, 1);
                    continue;
                }
                
                // Check if ball passed net
                if (!nets[i].passed && nets[i].x + netWidth < ball.x) {
                    nets[i].passed = true;
                    score++;
                    scoreElement.textContent = score;
                    updateLevel(); // Check for level up
                }
            }
        }

        // Check collisions
        function checkCollisions() {
            // Check if ball hits the boundaries
            if (ball.y <= 0 || ball.y + ball.size >= canvas.height) {
                return true;
            }
            
            // Check if ball hits nets
            for (let net of nets) {
                if (ball.x + ball.size > net.x && ball.x < net.x + netWidth) {
                    if (ball.y < net.gapY || ball.y + ball.size > net.gapY + netGap) {
                        return true;
                    }
                }
            }
            
            return false;
        }

        // Draw tennis ball
        function drawBall() {
            // Ball shadow
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.beginPath();
            ctx.arc(ball.x + ball.size/2 + 2, ball.y + ball.size/2 + 2, ball.size/2, 0, Math.PI * 2);
            ctx.fill();
            
            // Ball body
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.arc(ball.x + ball.size/2, ball.y + ball.size/2, ball.size/2, 0, Math.PI * 2);
            ctx.fill();
            
            // Ball outline
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Ball texture lines
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(ball.x + ball.size/2 - ball.size/3, ball.y + ball.size/2);
            ctx.lineTo(ball.x + ball.size/2 + ball.size/3, ball.y + ball.size/2);
            ctx.stroke();
            
            // Ball highlight
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.beginPath();
            ctx.arc(ball.x + ball.size/2 - 3, ball.y + ball.size/2 - 3, 3, 0, Math.PI * 2);
            ctx.fill();
        }

        // Draw tennis player
        function drawPlayer() {
            // Player shadow
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.fillRect(player.x + 2, player.y + 2, player.width, player.height);
            
            // Player body (shirt)
            ctx.fillStyle = '#ff6b6b';
            ctx.fillRect(player.x, player.y + 10, player.width, 20);
            
            // Player head
            ctx.fillStyle = '#ffdbac';
            ctx.beginPath();
            ctx.arc(player.x + player.width/2, player.y + 8, 8, 0, Math.PI * 2);
            ctx.fill();
            
            // Animated arms based on movement
            ctx.fillStyle = '#ffdbac';
            const armSwing = Math.sin(frameCount * 0.1) * 3;
            // Left arm (racket arm)
            ctx.fillRect(player.x - 3, player.y + 12 + armSwing, 6, 12);
            // Right arm (swinging arm)
            ctx.fillRect(player.x + player.width - 3, player.y + 12 - armSwing, 6, 12);
            
            // Animated legs based on movement
            ctx.fillStyle = '#4a90e2';
            const legSwing = Math.sin(frameCount * 0.15) * 2;
            // Left leg
            ctx.fillRect(player.x + 3, player.y + 30 + legSwing, 6, 10);
            // Right leg
            ctx.fillRect(player.x + player.width - 9, player.y + 30 - legSwing, 6, 10);
            
            // Player shoes
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(player.x + 2, player.y + 40, 8, 4);
            ctx.fillRect(player.x + player.width - 10, player.y + 40, 8, 4);
            
            // Tennis racket with dynamic positioning
            ctx.fillStyle = '#8b4513';
            ctx.fillRect(player.racketX, player.racketY, 3, 20); // Handle
            
            // Racket head with slight movement
            const racketSwing = Math.sin(frameCount * 0.2) * 2;
            ctx.fillStyle = '#ffffff';
            ctx.beginPath();
            ctx.arc(player.racketX + 15 + racketSwing, player.racketY + 10, 12, 0, Math.PI * 2);
            ctx.fill();
            
            // Racket strings
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 1;
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                ctx.moveTo(player.racketX + 3, player.racketY + 4 + i * 3);
                ctx.lineTo(player.racketX + 27 + racketSwing, player.racketY + 4 + i * 3);
                ctx.stroke();
            }
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                ctx.moveTo(player.racketX + 3 + i * 6, player.racketY + 4);
                ctx.lineTo(player.racketX + 3 + i * 6, player.racketY + 16);
                ctx.stroke();
            }
            
            // Player face details
            ctx.fillStyle = '#000000';
            ctx.beginPath();
            ctx.arc(player.x + player.width/2 - 2, player.y + 6, 1, 0, Math.PI * 2);
            ctx.arc(player.x + player.width/2 + 2, player.y + 6, 1, 0, Math.PI * 2);
            ctx.fill();
            
            // Player mouth (determined by movement)
            ctx.beginPath();
            if (Math.abs(player.targetX - player.x) > 10) {
                // Running - open mouth
                ctx.arc(player.x + player.width/2, player.y + 10, 2, 0, Math.PI * 2);
                ctx.fill();
            } else {
                // Standing - closed mouth
                ctx.arc(player.x + player.width/2, player.y + 10, 2, 0, Math.PI);
                ctx.stroke();
            }
            
            // Add motion lines when running fast
            if (Math.abs(player.targetX - player.x) > 15) {
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.6)';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(player.x - 5, player.y + 20);
                ctx.lineTo(player.x - 15, player.y + 20);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(player.x - 5, player.y + 30);
                ctx.lineTo(player.x - 15, player.y + 30);
                ctx.stroke();
            }
        }

        // Draw tennis nets
        function drawNets() {
            for (let net of nets) {
                // Net posts (top)
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(net.x - 5, 0, 10, net.gapY);
                
                // Net posts (bottom)
                ctx.fillRect(net.x - 5, net.gapY + netGap, 10, canvas.height - net.gapY - netGap);
                
                // Net mesh (top)
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 1;
                for (let i = 0; i < net.gapY; i += 10) {
                    ctx.beginPath();
                    ctx.moveTo(net.x, i);
                    ctx.lineTo(net.x + netWidth, i);
                    ctx.stroke();
                }
                for (let i = 0; i < netWidth; i += 10) {
                    ctx.beginPath();
                    ctx.moveTo(net.x + i, 0);
                    ctx.lineTo(net.x + i, net.gapY);
                    ctx.stroke();
                }
                
                // Net mesh (bottom)
                for (let i = net.gapY + netGap; i < canvas.height; i += 10) {
                    ctx.beginPath();
                    ctx.moveTo(net.x, i);
                    ctx.lineTo(net.x + netWidth, i);
                    ctx.stroke();
                }
                for (let i = 0; i < netWidth; i += 10) {
                    ctx.beginPath();
                    ctx.moveTo(net.x + i, net.gapY + netGap);
                    ctx.lineTo(net.x + i, canvas.height);
                    ctx.stroke();
                }
            }
        }

        // Draw court lines
        function drawCourtLines() {
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            for (let line of courtLines) {
                ctx.beginPath();
                ctx.moveTo(line.x, line.y);
                ctx.lineTo(line.x + line.width, line.y);
                ctx.stroke();
            }
        }

        // Draw background
        function drawBackground() {
            // Tennis court gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#2d5016');
            gradient.addColorStop(1, '#4a7c59');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw court lines
            drawCourtLines();
        }

        // Draw idle ball (for start screen)
        function drawIdleBall() {
            // Ball shadow
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.beginPath();
            ctx.arc(ball.x + ball.size/2 + 2, ball.y + ball.size/2 + 2, ball.size/2, 0, Math.PI * 2);
            ctx.fill();
            
            // Ball body
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.arc(ball.x + ball.size/2, ball.y + ball.size/2, ball.size/2, 0, Math.PI * 2);
            ctx.fill();
            
            // Ball outline
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Ball texture lines
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(ball.x + ball.size/2 - ball.size/3, ball.y + ball.size/2);
            ctx.lineTo(ball.x + ball.size/2 + ball.size/3, ball.y + ball.size/2);
            ctx.stroke();
            
            // Ball highlight
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.beginPath();
            ctx.arc(ball.x + ball.size/2 - 3, ball.y + ball.size/2 - 3, 3, 0, Math.PI * 2);
            ctx.fill();
        }

        // Game over
        function gameOver() {
            gameRunning = false;
            finalScoreElement.textContent = score;
            gameOverElement.style.display = 'block';
            
            const highScoreMessageElement = document.getElementById('highScoreMessage');
            if (score > nikhilHighScore) {
                highScoreMessageElement.textContent = `ðŸŽ‰ Congratulations! You beat Nikhil's high score of ${nikhilHighScore}!`;
                highScoreMessageElement.style.color = '#4CAF50';
            } else {
                highScoreMessageElement.textContent = `ðŸ˜” Your score (${score}) is lower than Nikhil's high score (${nikhilHighScore}).`;
                highScoreMessageElement.style.color = '#ff6b6b';
            }
        }

        // Restart game
        function restartGame() {
            init();
        }

        // Main game loop
        function gameLoop() {
            if (!gameRunning || countdownActive) return;
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background
            drawBackground();
            
            // Update game objects
            updateBall();
            updatePlayer(); // Update player position
            updateNets();
            
            // Create new nets
            if (frameCount % getCurrentNetFrequency() === 0) {
                createNet();
            }
            
            // Check collisions
            if (checkCollisions()) {
                gameOver();
                return;
            }
            
            // Draw game objects
            drawNets();
            drawBall();
            drawPlayer(); // Draw player
            
            frameCount++;
            requestAnimationFrame(gameLoop);
        }

        // Idle animation loop (for start screen)
        function idleLoop() {
            if (gameStarted && !countdownActive) return;
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background
            drawBackground();
            
            // Draw idle ball with gentle bouncing motion
            ball.y = 300 + Math.sin(frameCount * 0.02) * 10;
            drawIdleBall();
            
            // Update and draw player following the ball
            player.targetX = ball.x - 20;
            const dx = player.targetX - player.x;
            if (Math.abs(dx) > 5) {
                if (dx > 0) {
                    player.x += player.speed * 0.5; // Slower movement during idle
                } else {
                    player.x -= player.speed * 0.5;
                }
            }
            player.racketX = player.x + player.width + 5;
            player.racketY = player.y + 15;
            drawPlayer();
            
            frameCount++;
            requestAnimationFrame(idleLoop);
        }

        // Event listeners
        function bounce() {
            if (gameRunning) {
                ball.velocity = ball.bouncePower;
            }
        }

        canvas.addEventListener('click', bounce);
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                bounce();
            }
        });

        // Start the idle animation
        init();
        idleLoop();
    </script>
</body>
</html> 